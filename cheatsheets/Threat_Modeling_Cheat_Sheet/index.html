<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>Threat Modeling Cheat Sheet - OWASP Cheat Sheet Series</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "Threat Modeling Cheat Sheet";
    var mkdocs_page_input_path = "cheatsheets/Threat_Modeling_Cheat_Sheet.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OWASP Cheat Sheet Series</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../IndexASVS/">Index ASVS</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../IndexProactiveControls/">Index Proactive Controls</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../glossary/">Index Alphabetical</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cheatsheets</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../AJAX_Security_Cheat_Sheet/">AJAX Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Abuse_Case_Cheat_Sheet/">Abuse Case Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Access_Control_Cheat_Sheet/">Access Control Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Attack_Surface_Analysis_Cheat_Sheet/">Attack Surface Analysis Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Authentication_Cheat_Sheet/">Authentication Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Authorization_Testing_Automation/">Authorization Testing Automation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Bean_Validation_Cheat_Sheet/">Bean Validation Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../C-Based_Toolchain_Hardening/">C-Based Toolchain Hardening</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../C-Based_Toolchain_Hardening_Cheat_Sheet/">C-Based Toolchain Hardening Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Choosing_and_Using_Security_Questions_Cheat_Sheet/">Choosing and Using Security Questions Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Clickjacking_Defense_Cheat_Sheet/">Clickjacking Defense Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Content_Security_Policy_Cheat_Sheet/">Content Security Policy Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Credential_Stuffing_Prevention_Cheat_Sheet/">Credential Stuffing Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cross-Site_Request_Forgery_Prevention_Cheat_Sheet/">Cross-Site Request Forgery Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cross_Site_Scripting_Prevention_Cheat_Sheet/">Cross Site Scripting Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cryptographic_Storage_Cheat_Sheet/">Cryptographic Storage Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../DOM_based_XSS_Prevention_Cheat_Sheet/">DOM based XSS Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Database_Security_Cheat_Sheet/">Database Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Denial_of_Service_Cheat_Sheet/">Denial of Service Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Deserialization_Cheat_Sheet/">Deserialization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Docker_Security_Cheat_Sheet/">Docker Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../DotNet_Security_Cheat_Sheet/">DotNet Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Error_Handling_Cheat_Sheet/">Error Handling Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../File_Upload_Cheat_Sheet/">File Upload Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Forgot_Password_Cheat_Sheet/">Forgot Password Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../HTML5_Security_Cheat_Sheet/">HTML5 Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../HTTP_Strict_Transport_Security_Cheat_Sheet/">HTTP Strict Transport Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Injection_Prevention_Cheat_Sheet/">Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Injection_Prevention_Cheat_Sheet_in_Java/">Injection Prevention Cheat Sheet in Java</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Input_Validation_Cheat_Sheet/">Input Validation Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet/">Insecure Direct Object Reference Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../JAAS_Cheat_Sheet/">JAAS Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../JSON_Web_Token_Cheat_Sheet_for_Java/">JSON Web Token Cheat Sheet for Java</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Key_Management_Cheat_Sheet/">Key Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../LDAP_Injection_Prevention_Cheat_Sheet/">LDAP Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Logging_Cheat_Sheet/">Logging Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Mass_Assignment_Cheat_Sheet/">Mass Assignment Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Microservices_based_Security_Arch_Doc_Cheat_Sheet/">Microservices based Security Arch Doc Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Multifactor_Authentication_Cheat_Sheet/">Multifactor Authentication Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Nodejs_security_cheat_sheet/">Nodejs security cheat sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../OS_Command_Injection_Defense_Cheat_Sheet/">OS Command Injection Defense Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../PHP_Configuration_Cheat_Sheet/">PHP Configuration Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Password_Storage_Cheat_Sheet/">Password Storage Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Pinning_Cheat_Sheet/">Pinning Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Query_Parameterization_Cheat_Sheet/">Query Parameterization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../REST_Assessment_Cheat_Sheet/">REST Assessment Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../REST_Security_Cheat_Sheet/">REST Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Ruby_on_Rails_Cheatsheet/">Ruby on Rails Cheatsheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../SAML_Security_Cheat_Sheet/">SAML Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../SQL_Injection_Prevention_Cheat_Sheet/">SQL Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Securing_Cascading_Style_Sheets_Cheat_Sheet/">Securing Cascading Style Sheets Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Server_Side_Request_Forgery_Prevention_Cheat_Sheet/">Server Side Request Forgery Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Session_Management_Cheat_Sheet/">Session Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../TLS_Cipher_String_Cheat_Sheet/">TLS Cipher String Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Third_Party_Javascript_Management_Cheat_Sheet/">Third Party Javascript Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">Threat Modeling Cheat Sheet</a>
    <ul class="current">
    </ul>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Transaction_Authorization_Cheat_Sheet/">Transaction Authorization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Transport_Layer_Protection_Cheat_Sheet/">Transport Layer Protection Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Unvalidated_Redirects_and_Forwards_Cheat_Sheet/">Unvalidated Redirects and Forwards Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../User_Privacy_Protection_Cheat_Sheet/">User Privacy Protection Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Virtual_Patching_Cheat_Sheet/">Virtual Patching Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vulnerability_Disclosure_Cheat_Sheet/">Vulnerability Disclosure Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vulnerable_Dependency_Management_Cheat_Sheet/">Vulnerable Dependency Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Web_Service_Security_Cheat_Sheet/">Web Service Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../XML_External_Entity_Prevention_Cheat_Sheet/">XML External Entity Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../XML_Security_Cheat_Sheet/">XML Security Cheat Sheet</a>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OWASP Cheat Sheet Series</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Cheatsheets &raquo;</li>
        
      
    
    <li>Threat Modeling Cheat Sheet</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>Objective of the Threat Modelling Control Cheat Sheet – To provide guidance to architects, designers and reviewers, on deriving threat models for applications.</p>
<p>Audience for this cheat sheet</p>
<ol>
<li>Designers and Architects.</li>
<li>Threat Modeling SMEs or Security Assessors who are responsible for analyzing the security of the entire applications’ components.</li>
</ol>
<p>This cheat sheet provides guidance to assess existing apps as well as new apps. The instructions in here will help designer and architects address applications risks in an early stage of the development life cycle to help developers consider these risks while writing the code. It will also help assessors to look at risks from a comprehensive perspective.</p>
<p>Following the guidance in this cheat sheet, the assessors will list all possible risks and then verifies whether there are enough security controls to protect against these risks. The assessor will then give better recommendations on how to mitigate these risks. It will help the assessor discover logical attacks. In general, the threat modeling will help designers, architects and assessors discover logical attacks.</p>
<h1 id="preparation">Preparation<a class="headerlink" href="#preparation" title="Permanent link">&para;</a></h1>
<h2 id="understand-risk-management-basics-in-the-context-of-application-security">Understand Risk Management Basics in the context of Application Security<a class="headerlink" href="#understand-risk-management-basics-in-the-context-of-application-security" title="Permanent link">&para;</a></h2>
<p>Understand the Relation between Risk, Threats, and Vulnerabilities.</p>
<h2 id="threat-modeling-terminologies">Threat Modeling Terminologies<a class="headerlink" href="#threat-modeling-terminologies" title="Permanent link">&para;</a></h2>
<p><em>Information Asset</em>, a body of knowledge that is organized and managed as a single entity. Like any other corporate asset, an organization's information assets have financial value.</p>
<p><em>Threat Agent</em>, an individual or group that can manifest a threat. It is fundamental to identify who would want to exploit the assets of a company, and how they might use them against the company. </p>
<p><em>Attack Surface</em>, the sum of the different points (the "attack vectors") where an unauthorized user (the "attacker") can try to enter data to or extract data from an environment.</p>
<p><em>Likelihood</em>, the possibility of a a threat event occurring where a threat actor will exploit a weakness. The likelihood of threat events resulting in adverse impacts estimates the possibility that a threat event would result in an actual outcome. The combined analysis of both threat assessment vectors impacts established an overall threat likelihood.</p>
<p><em>Impact</em>, the potential damage (physical, logical, monetary loss, etc) of a threat event.</p>
<p><em>Control</em> a safeguard or countermeasure to avoid, detect, counteract, or minimize security risks to information, computer systems, or other assets.</p>
<p><em>Mitigation</em> A systematic reduction of risk or likelihood's impact to an asset.</p>
<p><em>Tractability Matrix</em>, a grid that allows documentation and easy viewing of what is required for a system's security.</p>
<h2 id="define-objectives">Define Objectives<a class="headerlink" href="#define-objectives" title="Permanent link">&para;</a></h2>
<p>Before starting the threat modeling process; it is important to identify business objectives of the applications, and identify security &amp; compliance requirements. This is very important to be defined in advance to help to evaluate the impact of any vulnerability during the risk analysis process.</p>
<h1 id="identify-application-design">Identify application design<a class="headerlink" href="#identify-application-design" title="Permanent link">&para;</a></h1>
<p>Understanding application design is a key activity to perform application threat modeling. It will enable the user of this cheat sheet to draw an accurate data flow diagram. Therefore, it will be easier to identify all possible risks. Moreover, the more the user of this cheat sheet understands application design, the better they will understand logical application attacks. The objective of the design document is to enumerate application components.</p>
<h2 id="review-the-application-design-document">Review the application design document<a class="headerlink" href="#review-the-application-design-document" title="Permanent link">&para;</a></h2>
<p>If you are not performing threat modeling during the development (in the design phase) so you have to review the application design documents to understand the application structure and to help to generate the data flow diagram. If there are no available design documents so you have to create one. Move to the next section</p>
<h2 id="create-design-documents">Create design documents<a class="headerlink" href="#create-design-documents" title="Permanent link">&para;</a></h2>
<p>There are many ways to generate design documents; the <strong>4+1</strong> view model is one of the matured approaches to building your design document. </p>
<p>Reference to <strong>4+1</strong> view model of architecture <a href="https://en.wikipedia.org/wiki/4%2B1_architectural_view_model">here</a>.</p>
<p>Please note that the <strong>4+1</strong> is comprehensive, you may use any other design model during this phase.</p>
<p>The following subsections show the details about <strong>4+1</strong> approach and how this could help in the threat modeling process:</p>
<h3 id="logical-view">Logical View<a class="headerlink" href="#logical-view" title="Permanent link">&para;</a></h3>
<p>Create a logical map of the Target of Evaluation.</p>
<p><strong>Audience</strong>: Designers.</p>
<p><strong>Area</strong>: Functional Requirements: describes the design's object model.</p>
<p><strong>Related Artifacts</strong>: Design model</p>
<h3 id="implementation-view">Implementation View<a class="headerlink" href="#implementation-view" title="Permanent link">&para;</a></h3>
<p><strong>Audience</strong>:  Programmers.</p>
<p><strong>Area</strong>:  Software components: describes the layers and subsystems of the application.</p>
<p><strong>Related Artifacts</strong>:  Implementation model, components</p>
<p>Please refer to the image in the appendix section for sample design for the implementation view.</p>
<h3 id="process-view">Process View<a class="headerlink" href="#process-view" title="Permanent link">&para;</a></h3>
<p><strong>Audience</strong>:  Integrators.</p>
<p><strong>Area</strong>:  Non-functional requirements: describes the design's concurrency and synchronization aspects.</p>
<p><strong>Related Artifacts</strong>:  (no specific artifact).</p>
<h3 id="deployment-view">Deployment View<a class="headerlink" href="#deployment-view" title="Permanent link">&para;</a></h3>
<p>Create a physical map of the Target of Evaluation</p>
<p><strong>Audience</strong>: Deployment managers.</p>
<p><strong>Area</strong>: Topology: describes the mapping of the software onto the hardware and shows the system's distributed aspects.</p>
<p><strong>Related Artifacts</strong>: Deployment model.</p>
<h3 id="use-case-view">Use-Case View<a class="headerlink" href="#use-case-view" title="Permanent link">&para;</a></h3>
<p><strong>Audience</strong>: All the stakeholders of the system, including the end-users.</p>
<p><strong>Area</strong>:  describes the set of scenarios and/or use cases that represent some significant, central functionality of the system.</p>
<p><strong>Related Artifacts</strong>:  Use-Case Model, Use-Case documents</p>
<h1 id="decompose-and-model-the-system">Decompose and Model the System<a class="headerlink" href="#decompose-and-model-the-system" title="Permanent link">&para;</a></h1>
<p>Gain an understanding of how the system works to perform a threat model, it is important to understand how the system works and interacts with its ecosystem. To start with creating a high-level information flow diagram, like the following:</p>
<ol>
<li>Identify the trusted boundaries of your system/application/module/ecosystem that you may want to start off with.</li>
<li>Add actors – internal and external</li>
<li>Define internal trusted boundaries. These can be the different security zones that have been designed</li>
<li>Relook at the actors you have identified in #2 for consistency</li>
<li>Add information flows</li>
<li>Identify the information elements and their classification as per your information classification policy</li>
<li>Where possible add assets to the identified information flows.</li>
</ol>
<h2 id="define-and-evaluate-your-assets">Define and Evaluate your Assets<a class="headerlink" href="#define-and-evaluate-your-assets" title="Permanent link">&para;</a></h2>
<p>Assets involved in the information flow should be defined and evaluated according to their value of confidentiality, integrity and availability.</p>
<h3 id="consider-data-in-transit-and-data-at-rest">Consider Data in transit and Data at rest<a class="headerlink" href="#consider-data-in-transit-and-data-at-rest" title="Permanent link">&para;</a></h3>
<p>Data protection in transit is the protection of this data while it’s traveling from network to network or being transferred from a local storage device to a cloud storage device – wherever data is moving, effective data protection measures for in-transit data are critical as data is often considered less secure while in motion.</p>
<p>While data at rest is sometimes considered to be less vulnerable than data in transit, attackers often find data at rest a more valuable target than data in motion.</p>
<p>The risk profile for data in transit or data at rest depends on the security measures that are in place to secure data in either state. Protecting sensitive data both in transit and at rest is imperative for modern enterprises as attackers find increasingly innovative ways to compromise systems and steal data.</p>
<h2 id="create-an-information-flow-diagram">Create an information flow diagram<a class="headerlink" href="#create-an-information-flow-diagram" title="Permanent link">&para;</a></h2>
<h3 id="whiteboard-your-architecture">Whiteboard Your Architecture<a class="headerlink" href="#whiteboard-your-architecture" title="Permanent link">&para;</a></h3>
<p>It is important to whiteboard system architecture by showing the major constraints and decisions in order to frame and start conversations. The value is actually twofold. If the architecture cannot be white-boarded, then it suggests that it is not well understood. If a clear and concise whiteboard diagram can be provided, others will understand it and it will be easier to communicate details.</p>
<h3 id="manage-to-present-your-dfd-in-the-context-of-mvc">Manage to present your DFD in the context of MVC<a class="headerlink" href="#manage-to-present-your-dfd-in-the-context-of-mvc" title="Permanent link">&para;</a></h3>
<p>In this step, Data Flow Diagram should be divided in the context of Model, View, Controller (MVC).</p>
<h3 id="use-tools-to-draw-your-diagram">Use tools to draw your diagram<a class="headerlink" href="#use-tools-to-draw-your-diagram" title="Permanent link">&para;</a></h3>
<p>If you don’t like to manually draw your DFD; there are several tools available that could be used:</p>
<h4 id="owasp-threat-dragon">OWASP Threat Dragon<a class="headerlink" href="#owasp-threat-dragon" title="Permanent link">&para;</a></h4>
<p>The OWASP <a href="https://owasp.org/www-project-threat-dragon/">Threat Dragon project</a> is a cross platform tool that runs on Linux, MacOS and Windows 10. Threat Dragon (TD) is used to create threat model diagrams and to record possible threats and decide on their mitigations using STRIDE methodology. TD is both a <a href="https://github.com/mike-goodwin/owasp-threat-dragon/releases/tag/v1.1">web application</a> and a <a href="https://github.com/mike-goodwin/owasp-threat-dragon-desktop/releases/tag/v1.1">desktop application</a>; in active development with version 1.1 released in March 2020.</p>
<h4 id="poirot">Poirot<a class="headerlink" href="#poirot" title="Permanent link">&para;</a></h4>
<p>The Poirot tool isolates and diagnoses defects through fault modeling and simulation. Along with a carefully selected partitioning strategy, functional and sequential test pattern applications show success with circuits having a high degree of observability.</p>
<h4 id="ms-tmt">MS TMT<a class="headerlink" href="#ms-tmt" title="Permanent link">&para;</a></h4>
<p>The Microsoft Threat Modeling Tool (TMT) helps find threats in the design phase of software projects. It is one of the longest lived threat modeling tools, having been introduced as Microsoft SDL in 2008, and is actively supported; <a href="https://aka.ms/threatmodelingtool">version 7.3</a> was released March 2020. It runs only on Windows 10 Anniversary Update or later, and so is difficult to use on MacOS or Linux.</p>
<h2 id="define-data-flow-over-your-dfd">Define Data Flow over your DFD<a class="headerlink" href="#define-data-flow-over-your-dfd" title="Permanent link">&para;</a></h2>
<p>Define Data Flows over the organization Data Flow Diagram.</p>
<h2 id="define-trust-boundaries">Define Trust Boundaries<a class="headerlink" href="#define-trust-boundaries" title="Permanent link">&para;</a></h2>
<p>Define any distinct boundaries (External boundaries and Internal boundaries) within which a system trusts all sub-systems (including data).</p>
<h2 id="define-applications-user-roles-and-trust-levels">Define applications user roles and trust levels<a class="headerlink" href="#define-applications-user-roles-and-trust-levels" title="Permanent link">&para;</a></h2>
<p>Define access rights that the application will grant to external entities and internal entities.</p>
<h2 id="highlight-authorization-per-user-role-over-the-dfd">Highlight Authorization per user role over the DFD<a class="headerlink" href="#highlight-authorization-per-user-role-over-the-dfd" title="Permanent link">&para;</a></h2>
<p>Highlight Authorization per user role, for example, defining app users’ role, admins’ role, anonymous visitors’ role...etc.</p>
<h2 id="define-application-entry-points">Define Application Entry points<a class="headerlink" href="#define-application-entry-points" title="Permanent link">&para;</a></h2>
<p>Define the interfaces through which potential attackers can interact with the application or supply them with data.</p>
<h1 id="identify-threat-agents">Identify Threat Agents<a class="headerlink" href="#identify-threat-agents" title="Permanent link">&para;</a></h1>
<h2 id="define-all-possible-threats">Define all possible threats<a class="headerlink" href="#define-all-possible-threats" title="Permanent link">&para;</a></h2>
<p>Identify Possible Attackers threat agents that could exist within the Target of Evaluation. Use Means, Motive, and Opportunities to understand Threats posed by Attackers. Then associate threat agents with system components they can directly interact with.</p>
<p>Work on minimizing the number of threat agents by:</p>
<ul>
<li>Treating them as equivalent classes.</li>
<li>Considering the attacker’s motivation when evaluating likelihood.</li>
<li>Consider insider Threats</li>
</ul>
<p>The user of this cheat can depend on the following list of risks and threat libraries sources to define the possible threats an application might be facing:</p>
<ol>
<li>Risks with <a href="https://owasp.org/www-project-top-ten/">OWASP Top 10</a>.</li>
<li>Testing Procedure with <a href="https://owasp.org/www-project-application-security-verification-standard/">OWASP ASVS</a>.</li>
<li>Risks with <a href="https://www.sans.org/top25-software-errors">SANS Top 25</a>.</li>
<li>Microsoft <a href="https://en.wikipedia.org/wiki/STRIDE_%28security%29">STRIDE</a>.</li>
</ol>
<h2 id="map-threat-agents-to-application-entry-points">Map Threat agents to application Entry points<a class="headerlink" href="#map-threat-agents-to-application-entry-points" title="Permanent link">&para;</a></h2>
<p>Map threat agents to the application entry point, whether it is a login process, a registration process or whatever it might be and consider insider Threats.</p>
<h2 id="draw-attack-vectors-and-attacks-tree">Draw attack vectors and attacks tree<a class="headerlink" href="#draw-attack-vectors-and-attacks-tree" title="Permanent link">&para;</a></h2>
<p>During this phase conduct the following activities:</p>
<ul>
<li>Draw attack vectors and attacks tree.</li>
<li>Identify Use Cases/Abuse Cases.</li>
<li>Re-Define attack vectors to consider multi-step attacks.</li>
</ul>
<h2 id="mapping-abuse-cases-to-use-cases">Mapping Abuse Cases to Use Cases<a class="headerlink" href="#mapping-abuse-cases-to-use-cases" title="Permanent link">&para;</a></h2>
<p>TODO</p>
<h2 id="re-define-attack-vectors">Re-Define attack vectors<a class="headerlink" href="#re-define-attack-vectors" title="Permanent link">&para;</a></h2>
<p>In most cases after defining the attack vectors, the compromised user role could lead to further attacks into the application. For example, assuming that an internet banking user credentials could be compromised, the user of this cheat sheet has to then redefine the attack vectors that could result from compromising the user’s credentials and so on.</p>
<h1 id="write-your-threat-traceability-matrix">Write your Threat traceability matrix<a class="headerlink" href="#write-your-threat-traceability-matrix" title="Permanent link">&para;</a></h1>
<h2 id="define-the-impact-and-probability-for-each-threat">Define the Impact and Probability for each threat<a class="headerlink" href="#define-the-impact-and-probability-for-each-threat" title="Permanent link">&para;</a></h2>
<p>Enumerate Attacks posed by the most dangerous attacker in designated areas of the logical and physical maps of the target of evaluation.</p>
<p>Assume the attacker has a zero-day because he does. In this methodology, we assume compromise; because a zero-day will exist or already does exist (even if we don't know about it). This is about what can be done by skilled attackers, with much more time, money, motive and opportunity that we have.</p>
<p>Use risk management methodology to determine the risk behind the threat</p>
<p>Create risks in risk log for every identified threat or attack to any assets. A risk assessment methodology is followed in order to identify the risk level for each vulnerability and hence for each server.</p>
<p>Here we will highlight two risk methodology that could be used:</p>
<h3 id="dread">DREAD<a class="headerlink" href="#dread" title="Permanent link">&para;</a></h3>
<p><a href="https://en.wikipedia.org/wiki/DREAD_%28risk_assessment_model%29">DREAD</a>, is about evaluating each existing vulnerability using a mathematical formula to retrieve the vulnerability’s corresponding risk. The <strong>DREAD</strong> formula is divided into 5 main categories:</p>
<ul>
<li><strong>D</strong>amage - how bad would an attack be?</li>
<li><strong>R</strong>eproducibility - how easy it is to reproduce the attack?</li>
<li><strong>E</strong>xploitability - how much work is it to launch the attack?</li>
<li><strong>A</strong>ffected users - how many people will be impacted?</li>
<li><strong>D</strong>iscoverability - how easy it is to discover the threat?</li>
</ul>
<p><strong>DREAD</strong> formula is:</p>
<pre><code class="text">Risk Value = (Damage + Affected users) x (Reproducibility + Exploitability + Discoverability).
</code></pre>

<p>Then the risk level is determined using defined thresholds below.</p>
<h3 id="pasta">PASTA<a class="headerlink" href="#pasta" title="Permanent link">&para;</a></h3>
<p><a href="https://versprite.com/tag/pasta-threat-modeling/">PASTA</a>, Attack Simulation &amp; Threat Analysis (PASTA) is a complete methodology to perform application threat modeling. PASTA introduces a risk-centric methodology aimed at applying security countermeasures that are commensurate to the possible impact that could be sustained from defined threat models, vulnerabilities, weaknesses, and attack patterns.</p>
<p>PASTA introduces a complete risk analysis and evaluation procedures that you can follow to evaluate the risk for each of the identified threat. The main difference in using PASTA Approach is that you should evaluate the impact early on in the analysis phase instead of addressing the impact at the step of evaluating the risk.</p>
<p>The idea behind addressing the impact earlier in PASTA approach is that the audience that knows impact knows the consequences on a product or use case failures more than participants in the threat analysis phase.</p>
<p>Application security risk assessments are not enough because they are very binary and leverage a control framework basis for denoting risks. It is recommended to contextually look at threats impacts, probability and effectiveness of countermeasures that may be present. </p>
<pre><code class="text">R = (T * V * P * I) / Countermeasures
</code></pre>

<p>For more details <a href="https://owasp.org/www-pdf-archive/AppSecEU2012_PASTA.pdf">about PASTA</a>.</p>
<h2 id="rank-risks">Rank Risks<a class="headerlink" href="#rank-risks" title="Permanent link">&para;</a></h2>
<p>Using risk matrix rank risks from most severe to least severe based on Means, Motive &amp; Opportunity. Below is a sample risk matrix table, depending on your risk approach you can define different risk ranking matrix:</p>
<ul>
<li>Risk Value: 01 to 12 &rarr; Risk Level: <strong>Notice</strong></li>
<li>Risk Value: 13 to 18 &rarr; Risk Level: <strong>Low</strong></li>
<li>Risk Value: 19 to 36 &rarr; Risk Level: <strong>Medium</strong></li>
<li>Risk Value: 37 to 54 &rarr; Risk Level: <strong>High</strong></li>
</ul>
<h1 id="determine-countermeasures-and-mitigation">Determine countermeasures and mitigation.<a class="headerlink" href="#determine-countermeasures-and-mitigation" title="Permanent link">&para;</a></h1>
<p>Identify risk owners and agree on risk mitigation with risk owners and stakeholders. Provide the needed controls in forms of code upgrades and configuration updates to reduce risks to acceptable levels.</p>
<h2 id="identify-risk-owners">Identify risk owners<a class="headerlink" href="#identify-risk-owners" title="Permanent link">&para;</a></h2>
<p>For the assessors: After defining and analyzing the risks, the assessor should be working on the mitigation plan by firstly identifying risk owners which is the personnel that is responsible for mitigating the risk. i.e. one of the information security team or the development team.</p>
<p>For the designers or the architects: they should assign the risk mitigation to the development team to consider it while building the application.</p>
<h2 id="agree-on-risk-mitigation-with-risk-owners-and-stakeholders">Agree on risk mitigation with risk owners and stakeholders<a class="headerlink" href="#agree-on-risk-mitigation-with-risk-owners-and-stakeholders" title="Permanent link">&para;</a></h2>
<p>TODO</p>
<h2 id="build-your-risk-treatment-strategy">Build your risk treatment strategy<a class="headerlink" href="#build-your-risk-treatment-strategy" title="Permanent link">&para;</a></h2>
<ul>
<li><strong>Reduce:</strong> building controls if the form of code upgrades, confirming a specific design for the application or building a specific configuration during the deployment phase to make sure that application risk is reduced.</li>
<li><strong>Transfer:</strong> For a specific component in the application the risk can be transferred to an outsourced third party to develop that component and making sure that the third party is doing the right testing for the component; or during the deployment phase, outsourcing a third party to do the deployment and transferring that risk to that third party.</li>
<li><strong>Avoid:</strong> an example of avoiding the risk is disabling a specific function in the application that is the source for that risk.</li>
<li><strong>Accept:</strong> if the risk is within acceptable criteria set earlier, in that case, the designer risk owner can accept that risk.</li>
</ul>
<p>For the assessor, this is considered as the last step in the assessment process. The following steps should be conducted by the risk owner, however, the assessor shall engage in 6.5 (Testing risk treatment) to verify the remediation.</p>
<h2 id="select-appropriate-controls-to-mitigate-the-risk">Select appropriate controls to mitigate the risk<a class="headerlink" href="#select-appropriate-controls-to-mitigate-the-risk" title="Permanent link">&para;</a></h2>
<p>Selecting one of the controls to reduce the risk, either by upgrading the code, or building a specific configuration during the deployment phase and so on.</p>
<h2 id="test-risk-treatment-to-verify-remediation">Test risk treatment to verify remediation<a class="headerlink" href="#test-risk-treatment-to-verify-remediation" title="Permanent link">&para;</a></h2>
<p>Mitigation controls will not vanish the risk completely, rather, it would just reduce the risk. In this case, the user of this cheat sheet should measure the value of the risk after applying the mitigation controls. The value of the risk should be reduced to the acceptable criteria set earlier.</p>
<h2 id="reduce-risk-in-risk-log-for-verified-treated-risk">Reduce risk in risk log for verified treated risk<a class="headerlink" href="#reduce-risk-in-risk-log-for-verified-treated-risk" title="Permanent link">&para;</a></h2>
<p>After applying the mitigation and measuring the new risk value, the user of this cheat sheet should update the risk log to verify that risk has been reduced.</p>
<h2 id="periodically-retest-risk">Periodically retest risk<a class="headerlink" href="#periodically-retest-risk" title="Permanent link">&para;</a></h2>
<p>TODO</p>
<h1 id="appendix">Appendix<a class="headerlink" href="#appendix" title="Permanent link">&para;</a></h1>
<p>TODO: <em>Sample Design for Implementation View in 4+1 Model</em></p>
<p>TODO: <em>Sample Design for Implementation View in 4+1 Model</em></p>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../Transaction_Authorization_Cheat_Sheet/" class="btn btn-neutral float-right" title="Transaction Authorization Cheat Sheet">Next <span class="icon icon-circle-arrow-right"></span></a>
      
      
        <a href="../Third_Party_Javascript_Management_Cheat_Sheet/" class="btn btn-neutral" title="Third Party Javascript Management Cheat Sheet"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../Third_Party_Javascript_Management_Cheat_Sheet/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
        <span style="margin-left: 15px"><a href="../Transaction_Authorization_Cheat_Sheet/" style="color: #fcfcfc">Next &raquo;</a></span>
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>
